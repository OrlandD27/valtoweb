{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/PROYECTOS%20FLUTTER/valtoweb/app/api/libro-reclamaciones/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const formData = await request.json();\r\n\r\n    const emailBody = `\r\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; background-color: #f5f7fa;\">\r\n        <div style=\"background: linear-gradient(135deg, #0047BB 0%, #002677 100%); padding: 30px; text-align: center; border-radius: 10px 10px 0 0;\">\r\n          <h1 style=\"color: white; margin: 0; font-size: 28px;\">Libro de Reclamaciones</h1>\r\n          <p style=\"color: #e0e7ff; margin: 10px 0 0 0;\">VALTO Management Consulting</p>\r\n        </div>\r\n        \r\n        <div style=\"background-color: white; padding: 30px; border-radius: 0 0 10px 10px;\">\r\n          <h2 style=\"color: #0047BB; border-bottom: 2px solid #0047BB; padding-bottom: 10px;\">Datos del Consumidor</h2>\r\n          <table style=\"width: 100%; margin-bottom: 20px;\">\r\n            <tr>\r\n              <td style=\"padding: 8px 0; color: #666;\"><strong>Tipo de Documento:</strong></td>\r\n              <td style=\"padding: 8px 0;\">${formData.tipoDocumento}</td>\r\n            </tr>\r\n            <tr>\r\n              <td style=\"padding: 8px 0; color: #666;\"><strong>N√∫mero de Documento:</strong></td>\r\n              <td style=\"padding: 8px 0;\">${formData.numeroDocumento}</td>\r\n            </tr>\r\n            <tr>\r\n              <td style=\"padding: 8px 0; color: #666;\"><strong>Nombres:</strong></td>\r\n              <td style=\"padding: 8px 0;\">${formData.nombres}</td>\r\n            </tr>\r\n            <tr>\r\n              <td style=\"padding: 8px 0; color: #666;\"><strong>Apellidos:</strong></td>\r\n              <td style=\"padding: 8px 0;\">${formData.apellidos}</td>\r\n            </tr>\r\n            <tr>\r\n              <td style=\"padding: 8px 0; color: #666;\"><strong>Domicilio:</strong></td>\r\n              <td style=\"padding: 8px 0;\">${formData.domicilio}</td>\r\n            </tr>\r\n            <tr>\r\n              <td style=\"padding: 8px 0; color: #666;\"><strong>Ubicaci√≥n:</strong></td>\r\n              <td style=\"padding: 8px 0;\">${formData.departamento}, ${formData.provincia}, ${formData.distrito}</td>\r\n            </tr>\r\n            <tr>\r\n              <td style=\"padding: 8px 0; color: #666;\"><strong>Tel√©fono:</strong></td>\r\n              <td style=\"padding: 8px 0;\">${formData.telefono}</td>\r\n            </tr>\r\n            <tr>\r\n              <td style=\"padding: 8px 0; color: #666;\"><strong>Email:</strong></td>\r\n              <td style=\"padding: 8px 0;\">${formData.email}</td>\r\n            </tr>\r\n          </table>\r\n\r\n          ${formData.esApoderado ? `\r\n          <h2 style=\"color: #0047BB; border-bottom: 2px solid #0047BB; padding-bottom: 10px; margin-top: 30px;\">Datos del Apoderado</h2>\r\n          <table style=\"width: 100%; margin-bottom: 20px;\">\r\n            <tr>\r\n              <td style=\"padding: 8px 0; color: #666;\"><strong>Tipo de Documento:</strong></td>\r\n              <td style=\"padding: 8px 0;\">${formData.apoderadoTipoDoc}</td>\r\n            </tr>\r\n            <tr>\r\n              <td style=\"padding: 8px 0; color: #666;\"><strong>N√∫mero de Documento:</strong></td>\r\n              <td style=\"padding: 8px 0;\">${formData.apoderadoNumDoc}</td>\r\n            </tr>\r\n            <tr>\r\n              <td style=\"padding: 8px 0; color: #666;\"><strong>Nombres:</strong></td>\r\n              <td style=\"padding: 8px 0;\">${formData.apoderadoNombres}</td>\r\n            </tr>\r\n            <tr>\r\n              <td style=\"padding: 8px 0; color: #666;\"><strong>Apellidos:</strong></td>\r\n              <td style=\"padding: 8px 0;\">${formData.apoderadoApellidos}</td>\r\n            </tr>\r\n            <tr>\r\n              <td style=\"padding: 8px 0; color: #666;\"><strong>Domicilio:</strong></td>\r\n              <td style=\"padding: 8px 0;\">${formData.apoderadoDomicilio}</td>\r\n            </tr>\r\n            <tr>\r\n              <td style=\"padding: 8px 0; color: #666;\"><strong>Tel√©fono:</strong></td>\r\n              <td style=\"padding: 8px 0;\">${formData.apoderadoTelefono}</td>\r\n            </tr>\r\n            <tr>\r\n              <td style=\"padding: 8px 0; color: #666;\"><strong>Email:</strong></td>\r\n              <td style=\"padding: 8px 0;\">${formData.apoderadoEmail}</td>\r\n            </tr>\r\n          </table>\r\n          ` : ''}\r\n\r\n          <h2 style=\"color: #0047BB; border-bottom: 2px solid #0047BB; padding-bottom: 10px; margin-top: 30px;\">Identificaci√≥n del Bien Contratado</h2>\r\n          <table style=\"width: 100%; margin-bottom: 20px;\">\r\n            <tr>\r\n              <td style=\"padding: 8px 0; color: #666;\"><strong>Tipo de Solicitud:</strong></td>\r\n              <td style=\"padding: 8px 0;\"><span style=\"background-color: ${formData.tipoSolicitud === 'reclamo' ? '#ef4444' : '#f59e0b'}; color: white; padding: 4px 12px; border-radius: 20px; font-weight: bold; text-transform: uppercase; font-size: 12px;\">${formData.tipoSolicitud}</span></td>\r\n            </tr>\r\n            <tr>\r\n              <td style=\"padding: 8px 0; color: #666;\"><strong>Tipo de Servicio:</strong></td>\r\n              <td style=\"padding: 8px 0;\">${formData.tipoServicio}</td>\r\n            </tr>\r\n            <tr>\r\n              <td style=\"padding: 8px 0; color: #666;\"><strong>Descripci√≥n del Servicio:</strong></td>\r\n              <td style=\"padding: 8px 0;\">${formData.descripcionServicio}</td>\r\n            </tr>\r\n            ${formData.montoReclamado ? `\r\n            <tr>\r\n              <td style=\"padding: 8px 0; color: #666;\"><strong>Monto Reclamado:</strong></td>\r\n              <td style=\"padding: 8px 0; font-weight: bold; color: #0047BB;\">${formData.montoReclamado}</td>\r\n            </tr>\r\n            ` : ''}\r\n          </table>\r\n\r\n          <h2 style=\"color: #0047BB; border-bottom: 2px solid #0047BB; padding-bottom: 10px; margin-top: 30px;\">Detalle de la Reclamaci√≥n</h2>\r\n          <div style=\"background-color: #f5f7fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;\">\r\n            <p style=\"margin: 0; line-height: 1.6; white-space: pre-wrap;\">${formData.detalleReclamacion}</p>\r\n          </div>\r\n\r\n          <h2 style=\"color: #0047BB; border-bottom: 2px solid #0047BB; padding-bottom: 10px; margin-top: 30px;\">Pedido del Consumidor</h2>\r\n          <div style=\"background-color: #f5f7fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;\">\r\n            <p style=\"margin: 0; line-height: 1.6; white-space: pre-wrap;\">${formData.pedidoConsumidor}</p>\r\n          </div>\r\n\r\n          <div style=\"background-color: #fffbeb; border-left: 4px solid #f59e0b; padding: 15px; margin-top: 30px; border-radius: 4px;\">\r\n            <p style=\"margin: 0; color: #92400e; font-size: 14px;\">\r\n              <strong>üìã Nota Legal:</strong> Este reclamo debe ser atendido en un plazo m√°ximo de 15 d√≠as h√°biles seg√∫n la normativa del C√≥digo de Protecci√≥n y Defensa del Consumidor.\r\n            </p>\r\n          </div>\r\n\r\n          <div style=\"text-align: center; margin-top: 30px; padding-top: 20px; border-top: 2px solid #e5e7eb;\">\r\n            <p style=\"color: #666; font-size: 12px; margin: 0;\">\r\n              VALTO Management Consulting<br>\r\n              Libro de Reclamaciones Digital<br>\r\n              Fecha de recepci√≥n: ${new Date().toLocaleString('es-PE', { timeZone: 'America/Lima' })}\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    `;\r\n\r\n    // Enviar email usando Resend\r\n    const resendResponse = await fetch('https://api.resend.com/emails', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'Authorization': `Bearer re_KHwh1TKa_87RCLR2WU9DG9zkurQ7yWPuz`\r\n      },\r\n      body: JSON.stringify({\r\n        from: 'VALTO Libro de Reclamaciones <onboarding@resend.dev>',\r\n        to: ['hostingmoder@gmail.com'],\r\n        subject: `[${formData.tipoSolicitud.toUpperCase()}] Libro de Reclamaciones - ${formData.nombres} ${formData.apellidos}`,\r\n        html: emailBody,\r\n        reply_to: formData.email\r\n      })\r\n    });\r\n\r\n    if (!resendResponse.ok) {\r\n      const errorData = await resendResponse.json();\r\n      console.error('Error de Resend:', errorData);\r\n      throw new Error('Error al enviar el correo');\r\n    }\r\n\r\n    const resendData = await resendResponse.json();\r\n    console.log('‚úÖ Email enviado:', resendData);\r\n\r\n    return NextResponse.json({ \r\n      success: true, \r\n      message: 'Reclamo enviado exitosamente',\r\n      emailId: resendData.id\r\n    });\r\n\r\n  } catch (error) {\r\n    console.error('‚ùå Error en API libro-reclamaciones:', error);\r\n    return NextResponse.json(\r\n      { success: false, error: 'Error al procesar el reclamo' },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,WAAW,MAAM,QAAQ,IAAI;QAEnC,MAAM,YAAY,CAAC;;;;;;;;;;;;0CAYmB,EAAE,SAAS,aAAa,CAAC;;;;0CAIzB,EAAE,SAAS,eAAe,CAAC;;;;0CAI3B,EAAE,SAAS,OAAO,CAAC;;;;0CAInB,EAAE,SAAS,SAAS,CAAC;;;;0CAIrB,EAAE,SAAS,SAAS,CAAC;;;;0CAIrB,EAAE,SAAS,YAAY,CAAC,EAAE,EAAE,SAAS,SAAS,CAAC,EAAE,EAAE,SAAS,QAAQ,CAAC;;;;0CAIrE,EAAE,SAAS,QAAQ,CAAC;;;;0CAIpB,EAAE,SAAS,KAAK,CAAC;;;;UAIjD,EAAE,SAAS,WAAW,GAAG,CAAC;;;;;0CAKM,EAAE,SAAS,gBAAgB,CAAC;;;;0CAI5B,EAAE,SAAS,eAAe,CAAC;;;;0CAI3B,EAAE,SAAS,gBAAgB,CAAC;;;;0CAI5B,EAAE,SAAS,kBAAkB,CAAC;;;;0CAI9B,EAAE,SAAS,kBAAkB,CAAC;;;;0CAI9B,EAAE,SAAS,iBAAiB,CAAC;;;;0CAI7B,EAAE,SAAS,cAAc,CAAC;;;UAG1D,CAAC,GAAG,GAAG;;;;;;yEAMwD,EAAE,SAAS,aAAa,KAAK,YAAY,YAAY,UAAU,wHAAwH,EAAE,SAAS,aAAa,CAAC;;;;0CAI/O,EAAE,SAAS,YAAY,CAAC;;;;0CAIxB,EAAE,SAAS,mBAAmB,CAAC;;YAE7D,EAAE,SAAS,cAAc,GAAG,CAAC;;;6EAGoC,EAAE,SAAS,cAAc,CAAC;;YAE3F,CAAC,GAAG,GAAG;;;;;2EAKwD,EAAE,SAAS,kBAAkB,CAAC;;;;;2EAK9B,EAAE,SAAS,gBAAgB,CAAC;;;;;;;;;;;;;kCAarE,EAAE,IAAI,OAAO,cAAc,CAAC,SAAS;YAAE,UAAU;QAAe,GAAG;;;;;IAKjG,CAAC;QAED,6BAA6B;QAC7B,MAAM,iBAAiB,MAAM,MAAM,iCAAiC;YAClE,QAAQ;YACR,SAAS;gBACP,gBAAgB;gBAChB,iBAAiB,CAAC,2CAA2C,CAAC;YAChE;YACA,MAAM,KAAK,SAAS,CAAC;gBACnB,MAAM;gBACN,IAAI;oBAAC;iBAAyB;gBAC9B,SAAS,CAAC,CAAC,EAAE,SAAS,aAAa,CAAC,WAAW,GAAG,2BAA2B,EAAE,SAAS,OAAO,CAAC,CAAC,EAAE,SAAS,SAAS,EAAE;gBACvH,MAAM;gBACN,UAAU,SAAS,KAAK;YAC1B;QACF;QAEA,IAAI,CAAC,eAAe,EAAE,EAAE;YACtB,MAAM,YAAY,MAAM,eAAe,IAAI;YAC3C,QAAQ,KAAK,CAAC,oBAAoB;YAClC,MAAM,IAAI,MAAM;QAClB;QAEA,MAAM,aAAa,MAAM,eAAe,IAAI;QAC5C,QAAQ,GAAG,CAAC,oBAAoB;QAEhC,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,SAAS;YACT,SAAS,WAAW,EAAE;QACxB;IAEF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,uCAAuC;QACrD,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAO,OAAO;QAA+B,GACxD;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}